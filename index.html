<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Sesli YZ Sohbet Botu</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #101010;
      color: white;
      text-align: center;
      margin: 0;
      padding: 0;
    }

    .avatar {
      margin-top: 40px;
      position: relative;
      width: 150px;
      height: 150px;
      margin-left: auto;
      margin-right: auto;
    }

    .face {
      background: #222;
      border-radius: 50%;
      width: 100%;
      height: 100%;
      position: relative;
    }

    .eye {
      width: 20px;
      height: 20px;
      background: white;
      border-radius: 50%;
      position: absolute;
      top: 40px;
      animation: blink 6s infinite;
    }

    .eye.left { left: 35px; }
    .eye.right { right: 35px; }

    @keyframes blink {
      0%, 95%, 100% { height: 20px; }
      96%, 98% { height: 2px; }
    }

    .mouth {
      width: 50px;
      height: 10px;
      background: red;
      border-radius: 10px;
      position: absolute;
      bottom: 35px;
      left: 50%;
      transform: translateX(-50%);
      transition: height 0.2s ease;
    }

    .talking .mouth {
      height: 25px;
    }

    .mic-button {
      margin-top: 30px;
      width: 80px;
      height: 80px;
      background-color: #444;
      border: none;
      border-radius: 50%;
      background-image: url('https://img.icons8.com/ios-filled/50/ffffff/microphone.png');
      background-size: 50%;
      background-repeat: no-repeat;
      background-position: center;
      cursor: pointer;
      transition: background-color 0.3s;
      user-select: none;
    }

    .mic-button:active {
      background-color: #666;
    }

    .status {
      margin-top: 20px;
      font-size: 18px;
      color: #ccc;
    }

    .logs {
      margin-top: 20px;
      max-height: 200px;
      overflow-y: auto;
      background: #1a1a1a;
      padding: 10px;
      font-size: 14px;
    }

    select {
      margin-top: 10px;
      padding: 5px;
      background: #222;
      color: white;
      border: 1px solid #444;
    }
  </style>
</head>
<body>

  <h1>🎤 Sesli YZ Sohbet Botu</h1>

  <div class="avatar" id="avatar">
    <div class="face">
      <div class="eye left"></div>
      <div class="eye right"></div>
      <div class="mouth"></div>
    </div>
  </div>

  <div class="status" id="status">Hazır</div>

  <button class="mic-button" id="micBtn"></button>

  <br><select id="langSelect">
    <option value="tr-TR">🇹🇷 Türkçe</option>
    <option value="en-US">🇺🇸 English</option>
  </select>

  <div class="logs" id="logs"></div>

  <script>
    const micBtn = document.getElementById("micBtn");
    const statusText = document.getElementById("status");
    const logs = document.getElementById("logs");
    const langSelect = document.getElementById("langSelect");
    const avatar = document.getElementById("avatar");

    let recognition;
    let isRecording = false;

    if ('webkitSpeechRecognition' in window) {
      recognition = new webkitSpeechRecognition();
    } else if ('SpeechRecognition' in window) {
      recognition = new SpeechRecognition();
    } else {
      alert("Tarayıcınız konuşma tanımayı desteklemiyor.");
    }

    if (recognition) {
      recognition.continuous = false;
      recognition.interimResults = false;

      recognition.onstart = () => {
        statusText.innerText = "🎧 Dinliyorum...";
      };

      recognition.onend = () => {
        statusText.innerText = "⏹️ Mikrofon kapalı.";
        isRecording = false;
      };

      recognition.onresult = (event) => {
        const transcript = event.results[0][0].transcript;
        logs.innerHTML += `<div><b>👤 Sen:</b> ${transcript}</div>`;
        respond(transcript);
      };
    }

    function respond(message) {
      statusText.innerText = "💬 Cevap veriyorum...";
      avatar.classList.add("talking");

      let response = "Seni tam anlayamadım.";
      message = message.toLowerCase();

      if (message.includes("merhaba")) response = "Merhaba! Nasılsın?";
      else if (message.includes("adın ne")) response = "Ben bir yapay zekayım!";
      else if (message.includes("nasılsın")) response = "Harikayım, sen?";

      logs.innerHTML += `<div><b>🤖 Bot:</b> ${response}</div>`;

      const utterance = new SpeechSynthesisUtterance(response);
      utterance.lang = langSelect.value;
      utterance.onend = () => {
        avatar.classList.remove("talking");
        statusText.innerText = "Hazır";
      };
      speechSynthesis.speak(utterance);
    }

    micBtn.addEventListener("mousedown", () => {
      if (recognition && !isRecording) {
        recognition.lang = langSelect.value;
        recognition.start();
        isRecording = true;
      }
    });

    micBtn.addEventListener("mouseup", () => {
      if (recognition && isRecording) {
        recognition.stop();
      }
    });

    micBtn.addEventListener("contextmenu", e => e.preventDefault()); // sağ tık engelle

  </script>
</body>
</html>
